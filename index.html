<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Payment Gateway</title>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    boxShadow: {
                        'soft': '0 4px 20px rgba(0,0,0,0.03)',
                        'up': '0 -4px 30px rgba(0,0,0,0.08)',
                        'card': '0 2px 12px rgba(0,0,0,0.04)'
                    },
                    animation: {
                        'fadeIn': 'fadeIn 0.3s ease-out',
                        'slideUp': 'slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1)',
                        'slideDown': 'slideDown 0.3s cubic-bezier(0.16, 1, 0.3, 1)',
                        'pulse-subtle': 'pulse-subtle 2s ease-in-out infinite'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(100%)' },
                            '100%': { transform: 'translateY(0)' }
                        },
                        slideDown: {
                            '0%': { transform: 'translateY(0)' },
                            '100%': { transform: 'translateY(100%)' }
                        },
                        'pulse-subtle': {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.7' }
                        }
                    }
                }
            }
        }
    </script>

    <!-- Custom CSS -->
    <style>
        html, body {
            height: 100%;
            overscroll-behavior-y: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .grid-rows-0 { grid-template-rows: 0fr; }
        .grid-rows-1 { grid-template-rows: 1fr; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #E5E7EB; border-radius: 10px; }
        
        .focus-ring:focus-within {
            box-shadow: 0 0 0 2px #fff, 0 0 0 4px #6366f1;
        }
        
        .safe-pb {
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }
        
        /* Smooth transitions */
        * {
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        
        /* Button press effect */
        .btn-press:active {
            transform: scale(0.98);
        }
        
        /* Loading spinner */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body class="bg-[#F2F4F7] text-gray-800 antialiased flex flex-col selection:bg-indigo-100 min-h-screen">

    <!-- Main App Container -->
    <div id="app" class="max-w-md mx-auto w-full flex-1 flex flex-col relative z-0 pb-32">
        
        <!-- Header -->
        <div class="h-2 w-full"></div>

        <!-- Merchant Card -->
        <div class="px-4 py-2">
            <div class="bg-white rounded-2xl shadow-soft border border-white p-4 flex items-center gap-4">
                <div class="w-14 h-14 bg-gradient-to-br from-indigo-600 to-purple-700 rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-md shrink-0">
                    SN
                </div>
                <div class="flex-1 flex flex-col justify-center">
                    <div class="flex items-center justify-between">
                        <h1 class="text-lg font-extrabold text-gray-900 tracking-tight leading-none">SKY NET</h1>
                        <div class="flex items-center gap-1 text-[10px] font-bold text-emerald-700 bg-emerald-50 px-2 py-0.5 rounded-full border border-emerald-100">
                            <i data-lucide="shield-check" class="w-[10px] h-[10px] fill-emerald-600 text-white"></i>
                            <span>VERIFIED</span>
                        </div>
                    </div>
                    <div class="mt-1.5 flex items-center gap-2 text-gray-500 text-sm font-medium">
                        <i data-lucide="phone" class="w-3.5 h-3.5 text-gray-400"></i>
                        <span>09-987654321</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Order ID -->
        <div class="px-4 mb-2 mt-1">
            <div class="flex items-center justify-between bg-indigo-50/50 rounded-xl px-4 py-3 border border-indigo-100/50">
                <span class="text-xs font-bold text-indigo-400 uppercase tracking-wider">Order ID</span>
                <button onclick="copyOrderId()" class="flex items-center gap-2 group cursor-pointer">
                    <span class="text-lg font-black text-indigo-900 tracking-tight">ORD-2025-8832</span>
                    <i data-lucide="copy" class="w-4 h-4 text-indigo-300 group-hover:text-indigo-600 transition-colors"></i>
                </button>
            </div>
            
            <!-- Toast -->
            <div id="toast" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gray-900 text-white px-4 py-3 rounded-xl text-sm font-medium shadow-lg opacity-0 pointer-events-none transition-all duration-300 z-50 flex items-center gap-2">
                <i data-lucide="check" class="w-4 h-4 text-emerald-400"></i> Copied to clipboard
            </div>
        </div>

        <!-- Order Summary -->
        <div class="px-4 mb-2">
            <div class="bg-white rounded-2xl shadow-card border border-white overflow-hidden">
                <button onclick="toggleSummary()" class="w-full flex items-center justify-between p-4 bg-white hover:bg-gray-50 active:bg-gray-100 transition-colors cursor-pointer">
                    <div class="flex items-center gap-2">
                        <div class="bg-orange-100 p-1.5 rounded-lg text-orange-600">
                            <i data-lucide="shopping-bag" class="w-4 h-4"></i>
                        </div>
                        <span class="text-sm font-bold text-gray-800 uppercase tracking-wide">Order Summary</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <span id="summary-preview" class="text-base font-bold text-gray-900">750 MMK</span>
                        <div id="summary-chevron" class="text-gray-400 bg-gray-100 rounded-full p-1 transition-transform duration-300">
                            <i data-lucide="chevron-down" class="w-4 h-4"></i>
                        </div>
                    </div>
                </button>
                
                <div id="summary-body" class="grid grid-rows-0 transition-[grid-template-rows] duration-300 ease-out">
                    <div class="overflow-hidden">
                        <div class="px-4 pb-4 border-t border-gray-50 bg-gray-50/30">
                            <div class="grid grid-cols-12 gap-2 py-3 text-[10px] font-bold text-gray-400 uppercase tracking-wider">
                                <div class="col-span-6">Product</div>
                                <div class="col-span-2 text-center">Qty</div>
                                <div class="col-span-4 text-right">Subtotal</div>
                            </div>
                            <div class="grid grid-cols-12 gap-2 py-2 text-sm text-gray-700 items-center border-b border-gray-100 pb-3 mb-2">
                                <div class="col-span-6 font-bold text-gray-900 leading-tight">Premium Plan (Monthly)</div>
                                <div class="col-span-2 text-center font-medium bg-white rounded-md py-0.5 border border-gray-100 shadow-sm text-xs">1</div>
                                <div class="col-span-4 text-right font-bold text-gray-900">750</div>
                            </div>
                            <div class="space-y-1.5 text-xs pt-1">
                                <div class="flex justify-between text-gray-500">
                                    <span>Service Fee</span>
                                    <span class="font-medium text-gray-900">0</span>
                                </div>
                                <div class="flex justify-between text-gray-500">
                                    <span>Tax (0%)</span>
                                    <span class="font-medium text-gray-900">0</span>
                                </div>
                            </div>
                            <div class="mt-3 pt-3 border-t border-dashed border-gray-300 flex justify-between items-center">
                                <span class="text-sm font-bold text-gray-900">Total Amount</span>
                                <span class="text-sm font-bold text-indigo-600">750 MMK</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment Method -->
        <div class="px-4 mb-2">
            <div class="bg-white rounded-2xl shadow-card border border-white p-4">
                <div class="flex items-center justify-between mb-3">
                    <span class="text-xs font-bold text-gray-400 uppercase tracking-wide">Pay With</span>
                    <button onclick="openModal()" class="text-xs font-bold text-indigo-600 px-2 py-1 bg-indigo-50 rounded-lg hover:bg-indigo-100 active:scale-95 transition-all cursor-pointer">
                        Change
                    </button>
                </div>
                
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 rounded-lg bg-gray-50 border border-gray-200 flex items-center justify-center shrink-0 overflow-hidden p-1">
                        <img id="selected-logo" src="" alt="Provider Logo" class="w-full h-full object-contain">
                    </div>
                    <div>
                        <h3 id="selected-name" class="font-bold text-gray-900 text-sm">Provider</h3>
                        <p id="selected-note" class="text-[10px] text-gray-500 font-medium">Note</p>
                    </div>
                </div>

                <!-- Dynamic Input Area -->
                <div id="dynamic-area"></div>
            </div>
        </div>

        <!-- Receipt Email -->
        <div class="px-4 mb-2">
            <div class="bg-white rounded-2xl shadow-card border border-white px-4 py-3 flex items-center justify-between hover:bg-gray-50 active:bg-gray-100 transition-colors cursor-pointer" onclick="alert('Email change functionality would go here')">
                <div class="flex items-center gap-3 overflow-hidden">
                    <div class="bg-gray-100 p-1.5 rounded-lg text-gray-500 shrink-0">
                        <i data-lucide="mail" class="w-4 h-4"></i>
                    </div>
                    <div class="flex flex-col overflow-hidden">
                        <span class="text-[10px] text-gray-400 font-bold uppercase tracking-wide">Receipt To</span>
                        <span class="text-xs font-bold text-gray-900 truncate">tartay.2100@gmail.com</span>
                    </div>
                </div>
                <i data-lucide="chevron-right" class="w-4 h-4 text-gray-300"></i>
            </div>
        </div>

        <!-- Session Timer -->
        <div class="px-4 mt-1">
            <div class="flex items-center justify-center gap-2 text-red-500 py-1">
                <i data-lucide="clock" class="w-3 h-3 animate-pulse-subtle"></i>
                <span class="text-[10px] font-semibold tracking-wide">SESSION EXPIRES IN <span id="timer" class="font-bold tabular-nums text-red-600 text-xs">08:12</span></span>
            </div>
        </div>

    </div>

    <!-- Fixed Bottom Bar -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-100 p-5 safe-pb z-40 rounded-t-3xl shadow-up">
        <div class="max-w-md mx-auto flex flex-col gap-4">
            <div class="flex items-center justify-between w-full">
                <span class="text-sm font-semibold text-gray-500">Total Amount</span>
                <span class="text-2xl font-black text-gray-900 leading-none">750 <span class="text-base font-bold text-gray-400">MMK</span></span>
            </div>
            <button onclick="processPayment()" id="pay-button" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2 text-lg btn-press">
                <i data-lucide="wallet" class="w-[22px] h-[22px]"></i>
                <span id="pay-btn-text">Pay Now</span>
            </button>
        </div>
    </div>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 hidden" onclick="closeModal()"></div>
    
    <!-- Modal Content -->
    <div id="modal-content" class="fixed bottom-0 left-0 right-0 z-[51] flex justify-center pointer-events-none hidden">
        <div class="w-full max-w-md bg-white rounded-t-3xl shadow-2xl flex flex-col max-h-[85vh] pointer-events-auto">
            <div class="flex items-center justify-between p-5 border-b border-gray-100 shrink-0">
                <h2 class="text-lg font-bold text-gray-900">Select Payment Method</h2>
                <button onclick="closeModal()" class="bg-gray-100 p-2 rounded-full text-gray-500 hover:bg-gray-200 transition-colors active:scale-95 cursor-pointer">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>

            <div id="provider-list" class="overflow-y-auto p-4 space-y-6 custom-scrollbar pb-10 safe-pb"></div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Payment providers data
        const PAYMENT_PROVIDERS = [
            { category: "QR Payments", id: "0.1", provider: "MMQR", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/MMQR_Logo.svg/240px-MMQR_Logo.svg.png", note: "Dynamic QR", requiresInput: false },
            { category: "Wallet", id: "1.1", provider: "MoMoney", logo: "https://play-lh.googleusercontent.com/j1ZiQVB8jFi2sZslkh1vN419gvRIN5VGif6749zljhWldRjmC7_dOF_y1jcuq3rwnQ", note: "Need Wallet Phone Number", requiresInput: true, inputLabel: "MoMoney Phone Number" },
            { category: "Wallet", id: "1.6", provider: "UAB Pay", logo: "https://play-lh.googleusercontent.com/j1ZiQVB8jFi2sZslkh1vN419gvRIN5VGif6749zljhWldRjmC7_dOF_y1jcuq3rwnQ", note: "Wallet Account / Phone", requiresInput: true, inputLabel: "UAB Pay Account / Phone" },
            { category: "Wallet", id: "1.2", provider: "WaveMoney", logo: "https://play-lh.googleusercontent.com/r_Sk_vQ5yZf7M9hK9rB_eX9u1g_T9f9hE8_y9j5s8hF_u1k7_q4p5_d3_z", note: "Redirect to Webpage", requiresInput: false },
            { category: "Wallet", id: "1.3", provider: "KBZ Pay", logo: "https://play-lh.googleusercontent.com/cnKJYzzHFAE5ZRepCsGVhv7ZnoDfK8Wu5z6lMefeT-45fTNfUblK_gF3JyW5VZsjFc4", note: "Redirect to App", requiresInput: false },
            { category: "Card", id: "2.1", provider: "MPU Card", logo: "https://upload.wikimedia.org/wikipedia/en/thumb/1/1d/Myanmar_Payment_Union_Logo.svg/240px-Myanmar_Payment_Union_Logo.svg.png", note: "Redirect to MPU", requiresInput: false },
            { category: "Card", id: "2.2", provider: "VISA / MASTER Card", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/240px-Visa_Inc._logo.svg.png", note: "Redirect to MPGS", requiresInput: false }
        ];

        // Application state
        let state = {
            selectedId: "1.1",
            phoneNumber: "09",
            isSummaryOpen: false,
            timeLeft: 492, // 8 minutes 12 seconds
            isProcessing: false
        };

        // DOM elements
        const elements = {
            selectedLogo: document.getElementById('selected-logo'),
            selectedName: document.getElementById('selected-name'),
            selectedNote: document.getElementById('selected-note'),
            dynamicArea: document.getElementById('dynamic-area'),
            payBtnText: document.getElementById('pay-btn-text'),
            modalOverlay: document.getElementById('modal-overlay'),
            modalContent: document.getElementById('modal-content'),
            providerList: document.getElementById('provider-list'),
            summaryBody: document.getElementById('summary-body'),
            summaryChevron: document.getElementById('summary-chevron'),
            summaryPreview: document.getElementById('summary-preview'),
            timer: document.getElementById('timer'),
            toast: document.getElementById('toast'),
            payButton: document.getElementById('pay-button')
        };

        // Initialize the application
        function init() {
            renderMainUI();
            startTimer();
            lucide.createIcons();
        }

        // Render main UI components
        function renderMainUI() {
            const provider = PAYMENT_PROVIDERS.find(p => p.id === state.selectedId);
            
            // Update provider info
            elements.selectedLogo.src = provider.logo;
            elements.selectedLogo.onerror = function() { 
                this.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" fill="#e5e7eb"><rect width="100" height="100" rx="10"/><text x="50%" y="50%" font-family="Arial" font-size="40" fill="#9ca3af" text-anchor="middle" dy=".3em">LOGO</text></svg>';
            };
            elements.selectedName.textContent = provider.provider;
            elements.selectedNote.textContent = provider.note;
            elements.payBtnText.textContent = `Pay with ${provider.provider}`;

            // Render dynamic input area
            if (provider.requiresInput) {
                const isValid = state.phoneNumber.length >= 7;
                
                elements.dynamicArea.innerHTML = `
                    <div class="mt-4 border-t border-gray-100 pt-4 animate-fadeIn">
                        <label class="text-xs font-bold text-gray-500 uppercase tracking-wide flex items-center gap-1 mb-2">
                            <i data-lucide="smartphone" class="w-3 h-3 text-gray-400"></i>
                            ${provider.inputLabel}
                        </label>
                        <div class="relative focus-ring rounded-xl">
                            <input 
                                type="tel" 
                                value="${state.phoneNumber}"
                                oninput="updatePhoneNumber(this.value)"
                                class="w-full bg-gray-50 border border-gray-200 rounded-xl py-3 px-4 text-gray-900 font-bold focus:outline-none focus:bg-white text-sm placeholder:text-gray-400"
                                placeholder="09xxxxxxxxx"
                                maxlength="11"
                            />
                            <div class="absolute right-3 top-1/2 -translate-y-1/2 transition-all ${isValid ? 'opacity-100 scale-100' : 'opacity-0 scale-75'}">
                                <div class="bg-emerald-100 text-emerald-600 p-1 rounded-full">
                                    <i data-lucide="check" class="w-3 h-3"></i>
                                </div>
                            </div>
                        </div>
                        ${!isValid && state.phoneNumber.length > 0 ? '<p class="text-xs text-amber-600 mt-2">Enter a valid phone number (09XXXXXXXXX)</p>' : ''}
                    </div>
                `;
            } else {
                const message = provider.id === "0.1" 
                    ? "A dynamic QR code will be generated for you to scan." 
                    : `You will be redirected to ${provider.provider} to complete payment.`;
                
                elements.dynamicArea.innerHTML = `
                    <div class="mt-4 bg-blue-50/50 rounded-lg p-3 border border-blue-100/50 flex gap-2 animate-fadeIn">
                        <div class="text-blue-500 mt-0.5"><i data-lucide="globe" class="w-3.5 h-3.5"></i></div>
                        <p class="text-xs text-blue-700 leading-relaxed font-medium">${message}</p>
                    </div>
                `;
            }
            
            lucide.createIcons();
        }

        // Render modal with provider list
        function renderModalList() {
            const categories = [...new Set(PAYMENT_PROVIDERS.map(p => p.category))];
            const categoryIcons = {
                "QR Payments": "qr-code",
                "Wallet": "smartphone",
                "Card": "credit-card"
            };
            
            let html = '';
            
            categories.forEach(category => {
                const providers = PAYMENT_PROVIDERS.filter(p => p.category === category);
                if (providers.length === 0) return;
                
                html += `
                    <div class="animate-fadeIn">
                        <div class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-2 flex items-center gap-2">
                            <i data-lucide="${categoryIcons[category]}" class="w-3.5 h-3.5"></i>
                            ${category === "Wallet" ? "Digital Wallets" : category}
                        </div>
                        <div class="space-y-2">
                `;
                
                providers.forEach(provider => {
                    const isSelected = provider.id === state.selectedId;
                    const borderClass = isSelected 
                        ? 'bg-indigo-50 border-indigo-500 ring-1 ring-indigo-500' 
                        : 'bg-white border-gray-100 hover:bg-gray-50';
                    
                    html += `
                        <div onclick="selectProvider('${provider.id}')" class="cursor-pointer w-full flex items-center gap-4 p-3 rounded-xl border transition-all duration-200 active:scale-95 ${borderClass}">
                            <div class="w-12 h-12 rounded-lg bg-white border border-gray-100 p-1 flex items-center justify-center shrink-0 overflow-hidden">
                                <img src="${provider.logo}" alt="${provider.provider}" class="w-full h-full object-contain" 
                                     onerror="this.src='data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\" fill=\"#f3f4f6\"><rect width=\"100\" height=\"100\" rx=\"10\"/><text x=\"50%\" y=\"50%\" font-family=\"Arial\" font-size=\"24\" fill=\"#9ca3af\" text-anchor=\"middle\" dy=\".3em\">${provider.provider.charAt(0)}</text></svg>'">
                            </div>
                            <div class="flex-1 text-left">
                                <div class="font-bold text-gray-900 text-sm">${provider.provider}</div>
                                <div class="text-xs text-gray-500 mt-0.5 line-clamp-1">${provider.note}</div>
                            </div>
                            <div class="w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ${isSelected ? 'border-indigo-600 bg-indigo-600' : 'border-gray-300'}">
                                ${isSelected ? '<div class="w-2 h-2 bg-white rounded-full"></div>' : ''}
                            </div>
                        </div>
                    `;
                });
                
                html += `</div></div>`;
            });
            
            elements.providerList.innerHTML = html;
            lucide.createIcons();
        }

        // Event handlers
        function updatePhoneNumber(value) {
            // Only allow numbers and ensure it starts with 09
            const cleanValue = value.replace(/[^\d]/g, '');
            state.phoneNumber = cleanValue.startsWith('09') ? cleanValue : '09' + cleanValue.substring(0, 9);
            
            // Re-render the input section to update validation state
            renderMainUI();
        }

        function selectProvider(id) {
            const provider = PAYMENT_PROVIDERS.find(p => p.id === id);
            
            // Reset phone number if switching to a provider that requires it
            if (provider.requiresInput && !state.phoneNumber.startsWith('09')) {
                state.phoneNumber = '09';
            }
            
            state.selectedId = id;
            closeModal();
            
            // Update UI after modal closes
            setTimeout(() => {
                renderMainUI();
            }, 300);
        }

        function toggleSummary() {
            state.isSummaryOpen = !state.isSummaryOpen;
            
            if (state.isSummaryOpen) {
                elements.summaryBody.classList.remove('grid-rows-0');
                elements.summaryBody.classList.add('grid-rows-1');
                elements.summaryChevron.classList.add('rotate-180');
                elements.summaryPreview.style.opacity = '0';
            } else {
                elements.summaryBody.classList.remove('grid-rows-1');
                elements.summaryBody.classList.add('grid-rows-0');
                elements.summaryChevron.classList.remove('rotate-180');
                setTimeout(() => {
                    elements.summaryPreview.style.opacity = '1';
                }, 200);
            }
        }

        function openModal() {
            renderModalList();
            
            elements.modalOverlay.classList.remove('hidden');
            elements.modalContent.classList.remove('hidden');
            
            // Animate in
            requestAnimationFrame(() => {
                elements.modalOverlay.classList.add('opacity-100');
                elements.modalContent.classList.add('animate-slideUp');
                elements.modalContent.classList.remove('animate-slideDown');
            });
        }

        function closeModal() {
            elements.modalOverlay.classList.remove('opacity-100');
            elements.modalContent.classList.remove('animate-slideUp');
            elements.modalContent.classList.add('animate-slideDown');
            
            setTimeout(() => {
                elements.modalOverlay.classList.add('hidden');
                elements.modalContent.classList.add('hidden');
                elements.modalContent.classList.remove('animate-slideDown');
            }, 300);
        }

        function copyOrderId() {
            const orderId = "ORD-2025-8832";
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(orderId).then(showToast);
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = orderId;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast();
            }
        }

        function showToast() {
            elements.toast.classList.remove('opacity-0', '-translate-y-8');
            elements.toast.classList.add('opacity-100', '-translate-y-12');
            
            setTimeout(() => {
                elements.toast.classList.remove('opacity-100', '-translate-y-12');
                elements.toast.classList.add('opacity-0');
            }, 2000);
        }

        function processPayment() {
            if (state.isProcessing) return;
            
            const provider = PAYMENT_PROVIDERS.find(p => p.id === state.selectedId);
            const isValidPhone = !provider.requiresInput || (state.phoneNumber.length >= 7 && state.phoneNumber.startsWith('09'));
            
            if (provider.requiresInput && !isValidPhone) {
                alert('Please enter a valid phone number');
                return;
            }
            
            // Show processing state
            state.isProcessing = true;
            elements.payButton.disabled = true;
            elements.payButton.innerHTML = `
                <i data-lucide="loader-2" class="w-6 h-6 animate-spin"></i>
                <span>Processing...</span>
            `;
            elements.payButton.classList.remove('hover:bg-indigo-700');
            
            // Simulate payment processing
            setTimeout(() => {
                state.isProcessing = false;
                elements.payButton.disabled = false;
                elements.payButton.innerHTML = `
                    <i data-lucide="wallet" class="w-[22px] h-[22px]"></i>
                    <span>Pay with ${provider.provider}</span>
                `;
                elements.payButton.classList.add('hover:bg-indigo-700');
                
                // Show success message
                alert(`Payment initiated with ${provider.provider}!${provider.requiresInput ? `\nPhone: ${state.phoneNumber}` : ''}`);
            }, 2000);
        }

        function startTimer() {
            const updateTimer = () => {
                if (state.timeLeft <= 0) {
                    elements.timer.textContent = "00:00";
                    elements.timer.parentElement.innerHTML = '<span class="text-red-600 text-xs font-bold">SESSION EXPIRED</span>';
                    return;
                }
                
                state.timeLeft--;
                const minutes = Math.floor(state.timeLeft / 60);
                const seconds = state.timeLeft % 60;
                elements.timer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Flash warning when under 2 minutes
                if (state.timeLeft === 120) {
                    elements.timer.parentElement.classList.add('text-red-600');
                }
                
                // Continue timer
                setTimeout(updateTimer, 1000);
            };
            
            updateTimer();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
